<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

### Table of Contents

-   [ePub][1]
    -   [Parameters][2]
    -   [Examples][3]
-   [Book][4]
    -   [Parameters][5]
    -   [Examples][6]
    -   [open][7]
        -   [Parameters][8]
        -   [Examples][9]
    -   [load][10]
        -   [Parameters][11]
    -   [resolve][12]
        -   [Parameters][13]
    -   [canonical][14]
        -   [Parameters][15]
    -   [section][16]
        -   [Parameters][17]
    -   [renderTo][18]
        -   [Parameters][19]
    -   [setRequestCredentials][20]
        -   [Parameters][21]
    -   [setRequestHeaders][22]
        -   [Parameters][23]
    -   [coverUrl][24]
    -   [getRange][25]
        -   [Parameters][26]
    -   [key][27]
        -   [Parameters][28]
    -   [destroy][29]
    -   [opened][30]
    -   [spine][31]
    -   [locations][32]
    -   [navigation][33]
    -   [pagelist][34]
-   [DisplayOptions][35]
    -   [Parameters][36]
    -   [parse][37]
        -   [Parameters][38]
-   [Url][39]
    -   [Parameters][40]
    -   [path][41]
    -   [resolve][42]
        -   [Parameters][43]
    -   [relative][44]
        -   [Parameters][45]
    -   [toString][46]
-   [Path][47]
    -   [Parameters][48]
    -   [parse][49]
        -   [Parameters][50]
    -   [isAbsolute][51]
        -   [Parameters][52]
    -   [isDirectory][53]
        -   [Parameters][54]
    -   [resolve][55]
        -   [Parameters][56]
    -   [relative][57]
        -   [Parameters][58]
    -   [toString][59]
-   [Spine][60]
    -   [unpack][61]
        -   [Parameters][62]
    -   [get][63]
        -   [Parameters][64]
        -   [Examples][65]
    -   [each][66]
    -   [first][67]
    -   [last][68]
-   [Section][69]
    -   [Parameters][70]
    -   [load][71]
        -   [Parameters][72]
    -   [render][73]
        -   [Parameters][74]
    -   [find][75]
        -   [Parameters][76]
    -   [search][77]
        -   [Parameters][78]
    -   [reconcileLayoutSettings][79]
        -   [Parameters][80]
    -   [cfiFromRange][81]
        -   [Parameters][82]
    -   [cfiFromElement][83]
        -   [Parameters][84]
    -   [unload][85]
-   [Locations][86]
    -   [Parameters][87]
    -   [generate][88]
        -   [Parameters][89]
    -   [generateFromWords][90]
        -   [Parameters][91]
    -   [locationFromCfi][92]
        -   [Parameters][93]
    -   [percentageFromCfi][94]
        -   [Parameters][95]
    -   [percentageFromLocation][96]
        -   [Parameters][97]
    -   [cfiFromLocation][98]
        -   [Parameters][99]
    -   [cfiFromPercentage][100]
        -   [Parameters][101]
    -   [load][102]
        -   [Parameters][103]
    -   [save][104]
    -   [currentLocation][105]
    -   [currentLocation][106]
        -   [Parameters][107]
    -   [length][108]
-   [Container][109]
    -   [Parameters][110]
    -   [parse][111]
        -   [Parameters][112]
-   [Packaging][113]
    -   [Parameters][114]
    -   [parse][115]
        -   [Parameters][116]
    -   [load][117]
        -   [Parameters][118]
-   [Navigation][119]
    -   [Parameters][120]
    -   [parse][121]
        -   [Parameters][122]
    -   [get][123]
        -   [Parameters][124]
    -   [getByIndex][125]
        -   [Parameters][126]
    -   [landmark][127]
        -   [Parameters][128]
    -   [load][129]
        -   [Parameters][130]
    -   [forEach][131]
        -   [Parameters][132]
-   [Resources][133]
    -   [Parameters][134]
    -   [process][135]
        -   [Parameters][136]
    -   [createUrl][137]
        -   [Parameters][138]
    -   [replacements][139]
    -   [relativeTo][140]
        -   [Parameters][141]
    -   [get][142]
        -   [Parameters][143]
    -   [substitute][144]
        -   [Parameters][145]
-   [PageList][146]
    -   [Parameters][147]
    -   [parse][148]
        -   [Parameters][149]
    -   [pageFromCfi][150]
        -   [Parameters][151]
    -   [cfiFromPage][152]
        -   [Parameters][153]
    -   [pageFromPercentage][154]
        -   [Parameters][155]
    -   [percentageFromPage][156]
        -   [Parameters][157]
    -   [percentageFromCfi][158]
        -   [Parameters][159]
    -   [destroy][160]
-   [Archive][161]
    -   [open][162]
        -   [Parameters][163]
    -   [openUrl][164]
        -   [Parameters][165]
    -   [request][166]
        -   [Parameters][167]
    -   [getBlob][168]
        -   [Parameters][169]
    -   [getText][170]
        -   [Parameters][171]
    -   [getBase64][172]
        -   [Parameters][173]
    -   [createUrl][174]
        -   [Parameters][175]
    -   [revokeUrl][176]
        -   [Parameters][177]
-   [Store][178]
    -   [Parameters][179]
    -   [add][180]
        -   [Parameters][181]
    -   [put][182]
        -   [Parameters][183]
    -   [request][184]
        -   [Parameters][185]
    -   [retrieve][186]
        -   [Parameters][187]
    -   [getBlob][188]
        -   [Parameters][189]
    -   [getText][190]
        -   [Parameters][191]
    -   [getBase64][192]
        -   [Parameters][193]
    -   [createUrl][194]
        -   [Parameters][195]
    -   [revokeUrl][196]
        -   [Parameters][197]
-   [Rendition][198]
    -   [Parameters][199]
    -   [setManager][200]
        -   [Parameters][201]
    -   [requireManager][202]
        -   [Parameters][203]
    -   [requireView][204]
        -   [Parameters][205]
    -   [start][206]
    -   [attachTo][207]
        -   [Parameters][208]
    -   [display][209]
        -   [Parameters][210]
    -   [moveTo][211]
        -   [Parameters][212]
    -   [resize][213]
        -   [Parameters][214]
    -   [clear][215]
    -   [next][216]
    -   [prev][217]
    -   [flow][218]
        -   [Parameters][219]
    -   [layout][220]
        -   [Parameters][221]
    -   [spread][222]
        -   [Parameters][223]
    -   [direction][224]
        -   [Parameters][225]
    -   [reportLocation][226]
    -   [currentLocation][227]
    -   [destroy][228]
    -   [getRange][229]
        -   [Parameters][230]
    -   [getContents][231]
    -   [views][232]
    -   [hooks][233]
    -   [themes][234]
    -   [annotations][235]
    -   [location][236]
        -   [Properties][237]
    -   [started][238]
    -   [started][239]
    -   [attached][240]
    -   [displayed][241]
        -   [Parameters][242]
    -   [displayError][243]
        -   [Parameters][244]
    -   [rendered][245]
        -   [Parameters][246]
    -   [removed][247]
        -   [Parameters][248]
    -   [resized][249]
        -   [Parameters][250]
    -   [orientationchange][251]
        -   [Parameters][252]
    -   [locationChanged][253]
        -   [Properties][254]
    -   [relocated][255]
    -   [selected][256]
        -   [Parameters][257]
    -   [markClicked][258]
        -   [Parameters][259]
-   [Hook][260]
    -   [Parameters][261]
    -   [Examples][262]
    -   [register][263]
        -   [Examples][264]
    -   [deregister][265]
        -   [Parameters][266]
        -   [Examples][267]
    -   [trigger][268]
        -   [Examples][269]
-   [Queue][270]
    -   [Parameters][271]
    -   [enqueue][272]
    -   [dequeue][273]
    -   [run][274]
    -   [flush][275]
    -   [clear][276]
    -   [length][277]
    -   [pause][278]
    -   [stop][279]
-   [Layout][280]
    -   [Parameters][281]
    -   [flow][282]
        -   [Parameters][283]
    -   [spread][284]
        -   [Parameters][285]
    -   [calculate][286]
        -   [Parameters][287]
    -   [format][288]
        -   [Parameters][289]
    -   [count][290]
        -   [Parameters][291]
-   [Themes][292]
    -   [Parameters][293]
    -   [register][294]
        -   [Examples][295]
    -   [default][296]
        -   [Parameters][297]
        -   [Examples][298]
    -   [registerThemes][299]
        -   [Parameters][300]
    -   [registerCss][301]
        -   [Parameters][302]
    -   [registerUrl][303]
        -   [Parameters][304]
    -   [registerRules][305]
        -   [Parameters][306]
    -   [select][307]
        -   [Parameters][308]
    -   [update][309]
        -   [Parameters][310]
    -   [inject][311]
        -   [Parameters][312]
    -   [add][313]
        -   [Parameters][314]
    -   [override][315]
        -   [Parameters][316]
    -   [overrides][317]
        -   [Parameters][318]
    -   [fontSize][319]
        -   [Parameters][320]
    -   [font][321]
        -   [Parameters][322]
-   [Annotations][323]
    -   [Parameters][324]
    -   [add][325]
        -   [Parameters][326]
    -   [remove][327]
        -   [Parameters][328]
    -   [highlight][329]
        -   [Parameters][330]
    -   [underline][331]
        -   [Parameters][332]
    -   [mark][333]
        -   [Parameters][334]
    -   [each][335]
    -   [show][336]
    -   [hide][337]
-   [Annotation][338]
    -   [Parameters][339]
    -   [update][340]
        -   [Parameters][341]
    -   [attach][342]
        -   [Parameters][343]
    -   [detach][344]
        -   [Parameters][345]
    -   [text][346]
-   [EpubCFI][347]
    -   [Parameters][348]
    -   [parse][349]
        -   [Parameters][350]
    -   [toString][351]
    -   [compare][352]
        -   [Parameters][353]
    -   [fromRange][354]
        -   [Parameters][355]
    -   [fromNode][356]
        -   [Parameters][357]
    -   [toRange][358]
        -   [Parameters][359]
    -   [isCfiString][360]
        -   [Parameters][361]
    -   [collapse][362]
        -   [Parameters][363]
-   [Contents][364]
    -   [Parameters][365]
    -   [width][366]
        -   [Parameters][367]
    -   [height][368]
        -   [Parameters][369]
    -   [contentWidth][370]
        -   [Parameters][371]
    -   [contentHeight][372]
        -   [Parameters][373]
    -   [textWidth][374]
    -   [textHeight][375]
    -   [scrollWidth][376]
    -   [scrollHeight][377]
    -   [overflow][378]
        -   [Parameters][379]
    -   [overflowX][380]
        -   [Parameters][381]
    -   [overflowY][382]
        -   [Parameters][383]
    -   [css][384]
        -   [Parameters][385]
    -   [viewport][386]
        -   [Parameters][387]
    -   [root][388]
    -   [locationOf][389]
        -   [Parameters][390]
    -   [addStylesheet][391]
        -   [Parameters][392]
    -   [addStylesheetCss][393]
        -   [Parameters][394]
    -   [addStylesheetRules][395]
        -   [Parameters][396]
    -   [addScript][397]
        -   [Parameters][398]
    -   [addClass][399]
        -   [Parameters][400]
    -   [removeClass][401]
        -   [Parameters][402]
    -   [range][403]
        -   [Parameters][404]
    -   [cfiFromRange][405]
        -   [Parameters][406]
    -   [cfiFromNode][407]
        -   [Parameters][408]
    -   [size][409]
        -   [Parameters][410]
    -   [columns][411]
        -   [Parameters][412]
    -   [scaler][413]
        -   [Parameters][414]
    -   [fit][415]
        -   [Parameters][416]
    -   [direction][417]
        -   [Parameters][418]
    -   [writingMode][419]
        -   [Parameters][420]
    -   [listenedEvents][421]
-   [Mapping][422]
    -   [Parameters][423]
    -   [section][424]
        -   [Parameters][425]
    -   [page][426]
        -   [Parameters][427]
    -   [axis][428]
        -   [Parameters][429]
-   [Core][430]
    -   [requestAnimationFrame][431]
    -   [uuid][432]
    -   [documentHeight][433]
    -   [isElement][434]
        -   [Parameters][435]
    -   [isNumber][436]
        -   [Parameters][437]
    -   [isFloat][438]
        -   [Parameters][439]
    -   [prefixed][440]
        -   [Parameters][441]
    -   [defaults][442]
        -   [Parameters][443]
    -   [extend][444]
        -   [Parameters][445]
    -   [insert][446]
        -   [Parameters][447]
    -   [locationOf][448]
        -   [Parameters][449]
    -   [indexOfSorted][450]
        -   [Parameters][451]
    -   [bounds][452]
        -   [Parameters][453]
    -   [borders][454]
        -   [Parameters][455]
    -   [nodeBounds][456]
        -   [Parameters][457]
    -   [windowBounds][458]
    -   [indexOfNode][459]
        -   [Parameters][460]
    -   [indexOfTextNode][461]
        -   [Parameters][462]
    -   [indexOfElementNode][463]
        -   [Parameters][464]
    -   [isXml][465]
        -   [Parameters][466]
    -   [createBlob][467]
        -   [Parameters][468]
    -   [createBlobUrl][469]
        -   [Parameters][470]
    -   [revokeBlobUrl][471]
        -   [Parameters][472]
    -   [createBase64Url][473]
        -   [Parameters][474]
    -   [type][475]
        -   [Parameters][476]
    -   [parse][477]
        -   [Parameters][478]
    -   [qs][479]
        -   [Parameters][480]
    -   [qsa][481]
        -   [Parameters][482]
    -   [qsp][483]
        -   [Parameters][484]
    -   [sprint][485]
        -   [Parameters][486]
    -   [treeWalker][487]
        -   [Parameters][488]
    -   [walk][489]
        -   [Parameters][490]
    -   [blob2base64][491]
        -   [Parameters][492]
    -   [defer][493]
    -   [querySelectorByType][494]
        -   [Parameters][495]
    -   [findChildren][496]
        -   [Parameters][497]
    -   [parents][498]
        -   [Parameters][499]
    -   [filterChildren][500]
        -   [Parameters][501]
    -   [getParentByTagName][502]
        -   [Parameters][503]
    -   [RangeObject][504]

## ePub

Creates a new Book

### Parameters

-   `url` **([string][505] \| [ArrayBuffer][506])** URL, Path or ArrayBuffer
-   `options` **[object][507]** to pass to the book

### Examples

```javascript
ePub("/path/to/book.epub", {})
```

Returns **[Book][508]** a new Book object

## Book

An Epub representation with methods for the loading, parsing and manipulation
of its contents.

### Parameters

-   `url` **[string][505]?** 
-   `options` **[object][507]?** 
    -   `options.requestMethod` **method?** a request function to use instead of the default
    -   `options.requestCredentials` **[boolean][509]** send the xhr request withCredentials (optional, default `undefined`)
    -   `options.requestHeaders` **[object][507]** send the xhr request headers (optional, default `undefined`)
    -   `options.encoding` **[string][505]** optional to pass 'binary' or base64' for archived Epubs (optional, default `binary`)
    -   `options.replacements` **[string][505]** use base64, blobUrl, or none for replacing assets in archived Epubs (optional, default `none`)
    -   `options.canonical` **method?** optional function to determine canonical urls for a path
    -   `options.openAs` **[string][505]?** optional string to determine the input type
    -   `options.store` **[string][505]** cache the contents in local storage, value should be the name of the reader (optional, default `false`)

### Examples

```javascript
new Book("/path/to/book.epub", {})
```

```javascript
new Book({ replacements: "blobUrl" })
```

Returns **[Book][508]** 

### open

Open a epub or url

#### Parameters

-   `input` **([string][505] \| [ArrayBuffer][506])** Url, Path or ArrayBuffer
-   `what` **[string][505]** force opening as a certain type (optional, default `"binary","base64","epub","opf","json","directory"`)

#### Examples

```javascript
book.open("/path/to/book.epub")
```

Returns **[Promise][510]** of when the book has been loaded

### load

Load a resource from the Book

#### Parameters

-   `path` **[string][505]** path to the resource to load

Returns **[Promise][510]** returns a promise with the requested resource

### resolve

Resolve a path to it's absolute position in the Book

#### Parameters

-   `path` **[string][505]** 
-   `absolute` **[boolean][509]?** force resolving the full URL

Returns **[string][505]** the resolved path string

### canonical

Get a canonical link to a path

#### Parameters

-   `path` **[string][505]** 

Returns **[string][505]** the canonical path string

### section

Gets a Section of the Book from the Spine
Alias for `book.spine.get`

#### Parameters

-   `target` **[string][505]** 

Returns **[Section][511]** 

### renderTo

Sugar to render a book to an element

#### Parameters

-   `element` **([element][512] \| [string][505])** element or string to add a rendition to
-   `options` **[object][507]?** 

Returns **[Rendition][513]** 

### setRequestCredentials

Set if request should use withCredentials

#### Parameters

-   `credentials` **[boolean][509]** 

### setRequestHeaders

Set headers request should use

#### Parameters

-   `headers` **[object][507]** 

### coverUrl

Get the cover url

Returns **[Promise][510]&lt;[string][505]?>** coverUrl

### getRange

Find a DOM Range for a given CFI Range

#### Parameters

-   `cfiRange` **[EpubCFI][514]** a epub cfi range

Returns **[Range][515]** 

### key

Generates the Book Key using the identifer in the manifest or other string provided

#### Parameters

-   `identifier` **[string][505]?** to use instead of metadata identifier

Returns **[string][505]** key

### destroy

Destroy the Book and all associated objects

### opened

### spine

Type: [Spine][516]

### locations

Type: [Locations][517]

### navigation

Type: [Navigation][518]

### pagelist

Type: [PageList][519]

## DisplayOptions

Open DisplayOptions Format Parser

### Parameters

-   `displayOptionsDocument` **[document][520]** XML

### parse

Parse XML

#### Parameters

-   `displayOptionsDocument` **[document][520]** XML

Returns **[DisplayOptions][521]** self

## Url

creates a Url object for parsing and manipulation of a url string

### Parameters

-   `urlString` **[string][505]** a url string (relative or absolute)
-   `baseString` **[string][505]?** optional base for the url,
    default to window.location.href

### path

Returns **[Path][522]** 

### resolve

Resolves a relative path to a absolute url

#### Parameters

-   `what` **[string][505]** 

Returns **[string][505]** url

### relative

Resolve a path relative to the url

#### Parameters

-   `what` **[string][505]** 

Returns **[string][505]** path

### toString

Returns **[string][505]** 

## Path

Creates a Path object for parsing and manipulation of a path strings

Uses a polyfill for Nodejs path: [https://nodejs.org/api/path.html][523]

### Parameters

-   `pathString` **[string][505]** a url string (relative or absolute)

### parse

Parse the path: [https://nodejs.org/api/path.html#path_path_parse_path][524]

#### Parameters

-   `what` **[string][505]** 

Returns **[object][507]** 

### isAbsolute

#### Parameters

-   `what` **[string][505]** 

Returns **[boolean][509]** 

### isDirectory

Check if path ends with a directory

#### Parameters

-   `what` **[string][505]** 

Returns **[boolean][509]** 

### resolve

Resolve a path against the directory of the Path

[https://nodejs.org/api/path.html#path_path_resolve_paths][525]

#### Parameters

-   `what` **[string][505]** 

Returns **[string][505]** resolved

### relative

Resolve a path relative to the directory of the Path

[https://nodejs.org/api/path.html#path_path_relative_from_to][526]

#### Parameters

-   `what` **[string][505]** 

Returns **[string][505]** relative

### toString

Return the path string

Returns **[string][505]** path

## Spine

A collection of Spine Items

### unpack

Unpack items from a opf into spine items

#### Parameters

-   `_package` **[Packaging][527]** 
-   `resolver` **method** URL resolver
-   `canonical` **method** Resolve canonical url

### get

Get an item from the spine

#### Parameters

-   `target` **([string][505] \| [number][528])?** 

#### Examples

```javascript
spine.get();
```

```javascript
spine.get(1);
```

```javascript
spine.get("chap1.html");
```

```javascript
spine.get("#id1234");
```

Returns **[Section][511]** section

### each

Loop over the Sections in the Spine

Returns **method** forEach

### first

Find the first Section in the Spine

Returns **[Section][511]** first section

### last

Find the last Section in the Spine

Returns **[Section][511]** last section

## Section

Represents a Section of the Book

In most books this is equivelent to a Chapter

### Parameters

-   `item` **[object][507]** The spine item representing the section
-   `hooks` **[object][507]** hooks for serialize and content

### load

Load the section from its url

#### Parameters

-   `_request` **method?** a request method to use for loading

Returns **[document][520]** a promise with the xml document

### render

Render the contents of a section

#### Parameters

-   `_request` **method?** a request method to use for loading

Returns **[string][505]** output a serialized XML Document

### find

Find a string in a section

#### Parameters

-   `_query` **[string][505]** The query string to find

Returns **[Array][529]&lt;[object][507]>** A list of matches, with form {cfi, excerpt}

### search

Search a string in multiple sequential Element of the section. If the document.createTreeWalker api is missed(eg: IE8), use `find` as a fallback.

#### Parameters

-   `_query` **[string][505]** The query string to search
-   `maxSeqEle` **int** The maximum number of Element that are combined for search, defualt value is 5. (optional, default `5`)

Returns **[Array][529]&lt;[object][507]>** A list of matches, with form {cfi, excerpt}

### reconcileLayoutSettings

Reconciles the current chapters layout properies with
the global layout properities.

#### Parameters

-   `globalLayout` **[object][507]** The global layout settings object, chapter properties string

Returns **[object][507]** layoutProperties Object with layout properties

### cfiFromRange

Get a CFI from a Range in the Section

#### Parameters

-   `_range` **[range][515]** 

Returns **[string][505]** cfi an EpubCFI string

### cfiFromElement

Get a CFI from an Element in the Section

#### Parameters

-   `el` **[element][512]** 

Returns **[string][505]** cfi an EpubCFI string

### unload

Unload the section document

## Locations

Find Locations for a Book

### Parameters

-   `spine` **[Spine][516]** 
-   `request` **[request][530]** 
-   `pause` **[number][528]**  (optional, default `100`)

### generate

Load all of sections in the book to generate locations

#### Parameters

-   `chars` **int** how many chars to split on

Returns **[object][507]** locations

### generateFromWords

Load all of sections in the book to generate locations

#### Parameters

-   `startCfi` **[string][505]** start position
-   `wordCount` **int** how many words to split on
-   `count` **int** result count

Returns **[object][507]** locations

### locationFromCfi

Get a location from an EpubCFI

#### Parameters

-   `cfi` **[EpubCFI][514]** 

Returns **[number][528]** 

### percentageFromCfi

Get a percentage position in locations from an EpubCFI

#### Parameters

-   `cfi` **[EpubCFI][514]** 

Returns **[number][528]** 

### percentageFromLocation

Get a percentage position from a location index

#### Parameters

-   `loc`  
-   `location` **[number][528]** 

Returns **[number][528]** 

### cfiFromLocation

Get an EpubCFI from location index

#### Parameters

-   `loc` **[number][528]** 

Returns **[EpubCFI][514]** cfi

### cfiFromPercentage

Get an EpubCFI from location percentage

#### Parameters

-   `percentage` **[number][528]** 

Returns **[EpubCFI][514]** cfi

### load

Load locations from JSON

#### Parameters

-   `locations` **[json][531]** 

### save

Save locations to JSON

Returns **[json][531]** 

### currentLocation

Get the current location

### currentLocation

Set the current location

#### Parameters

-   `curr`  

### length

Locations length

## Container

Handles Parsing and Accessing an Epub Container

### Parameters

-   `containerDocument` **[document][520]?** xml document

### parse

Parse the Container XML

#### Parameters

-   `containerDocument` **[document][520]** 

## Packaging

Open Packaging Format Parser

### Parameters

-   `packageDocument` **[document][520]** OPF XML

### parse

Parse OPF XML

#### Parameters

-   `packageDocument` **[document][520]** OPF XML

Returns **[object][507]** parsed package parts

### load

Load JSON Manifest

#### Parameters

-   `json`  
-   `packageDocument` **[document][520]** OPF XML

Returns **[object][507]** parsed package parts

## Navigation

Navigation Parser

### Parameters

-   `xml` **[document][520]** navigation html / xhtml / ncx

### parse

Parse out the navigation items

#### Parameters

-   `xml` **[document][520]** navigation html / xhtml / ncx

### get

Get an item from the navigation

#### Parameters

-   `target` **[string][505]** 

Returns **[object][507]** navItem

### getByIndex

Get an item from navigation subitems recursively by index

#### Parameters

-   `target` **[string][505]** 
-   `index` **[number][528]** 
-   `navItems` **[array][529]** 

Returns **[object][507]** navItem

### landmark

Get a landmark by type
List of types: [https://idpf.github.io/epub-vocabs/structure/][532]

#### Parameters

-   `type` **[string][505]** 

Returns **[object][507]** landmarkItem

### load

Load Spine Items

#### Parameters

-   `json` **[object][507]** the items to be loaded

Returns **[Array][529]** navItems

### forEach

forEach pass through

#### Parameters

-   `fn` **[Function][533]** function to run on each item

Returns **method** forEach loop

## Resources

Handle Package Resources

### Parameters

-   `manifest` **Manifest** 
-   `options` **[object][507]?** 
    -   `options.replacements` **[string][505]**  (optional, default `"base64"`)
    -   `options.archive` **[Archive][534]?** 
    -   `options.resolver` **method?** 

### process

Process resources

#### Parameters

-   `manifest` **Manifest** 

### createUrl

Create a url to a resource

#### Parameters

-   `url` **[string][505]** 

Returns **[Promise][510]&lt;[string][505]>** Promise resolves with url string

### replacements

Create blob urls for all the assets

Returns **[Promise][510]** returns replacement urls

### relativeTo

Resolve all resources URLs relative to an absolute URL

#### Parameters

-   `absolute` **[string][505]** to be resolved to
-   `resolver` **resolver?** 

Returns **[Array][529]&lt;[string][505]>** array with relative Urls

### get

Get a URL for a resource

#### Parameters

-   `path` **[string][505]** 

Returns **[string][505]** url

### substitute

Substitute urls in content, with replacements,
relative to a url if provided

#### Parameters

-   `content` **[string][505]** 
-   `url` **[string][505]?** url to resolve to

Returns **[string][505]** content with urls substituted

## PageList

Page List Parser

### Parameters

-   `xml` **[document][520]?** 

### parse

Parse PageList Xml

#### Parameters

-   `xml` **[document][520]** 

### pageFromCfi

Get a PageList result from a EpubCFI

#### Parameters

-   `cfi` **[string][505]** EpubCFI String

Returns **[number][528]** page

### cfiFromPage

Get an EpubCFI from a Page List Item

#### Parameters

-   `pg` **([string][505] \| [number][528])** 

Returns **[string][505]** cfi

### pageFromPercentage

Get a Page from Book percentage

#### Parameters

-   `percent` **[number][528]** 

Returns **[number][528]** page

### percentageFromPage

Returns a value between 0 - 1 corresponding to the location of a page

#### Parameters

-   `pg` **[number][528]** the page

Returns **[number][528]** percentage

### percentageFromCfi

Returns a value between 0 - 1 corresponding to the location of a cfi

#### Parameters

-   `cfi` **[string][505]** EpubCFI String

Returns **[number][528]** percentage

### destroy

Destroy

## Archive

Handles Unzipping a requesting files from an Epub Archive

### open

Open an archive

#### Parameters

-   `input` **binary** 
-   `isBase64` **[boolean][509]?** tells JSZip if the input data is base64 encoded

Returns **[Promise][510]** zipfile

### openUrl

Load and Open an archive

#### Parameters

-   `zipUrl` **[string][505]** 
-   `isBase64` **[boolean][509]?** tells JSZip if the input data is base64 encoded

Returns **[Promise][510]** zipfile

### request

Request a url from the archive

#### Parameters

-   `url` **[string][505]** a url to request from the archive
-   `type` **[string][505]?** specify the type of the returned result

Returns **[Promise][510]&lt;([Blob][535] \| [string][505] \| [JSON][531] \| [Document][520] | XMLDocument)>** 

### getBlob

Get a Blob from Archive by Url

#### Parameters

-   `url` **[string][505]** 
-   `mimeType` **[string][505]?** 

Returns **[Blob][535]** 

### getText

Get Text from Archive by Url

#### Parameters

-   `url` **[string][505]** 
-   `encoding` **[string][505]?** 

Returns **[string][505]** 

### getBase64

Get a base64 encoded result from Archive by Url

#### Parameters

-   `url` **[string][505]** 
-   `mimeType` **[string][505]?** 

Returns **[string][505]** base64 encoded

### createUrl

Create a Url from an unarchived item

#### Parameters

-   `url` **[string][505]** 
-   `options`  

Returns **[Promise][510]** url promise with Url string

### revokeUrl

Revoke Temp Url for a achive item

#### Parameters

-   `url` **[string][505]** url of the item in the archive

## Store

Handles saving and requesting files from local storage

### Parameters

-   `name` **[string][505]** This should be the name of the application for modals
-   `requester` **[function][533]?** 
-   `resolver` **[function][533]?** 

### add

Add all of a book resources to the store

#### Parameters

-   `resources` **[Resources][536]** book resources
-   `force` **[boolean][509]?** force resaving resources

Returns **[Promise][510]&lt;[object][507]>** store objects

### put

Put binary data from a url to storage

#### Parameters

-   `url` **[string][505]** a url to request from storage
-   `withCredentials` **[boolean][509]?** 
-   `headers` **[object][507]?** 

Returns **[Promise][510]&lt;[Blob][535]>** 

### request

Request a url

#### Parameters

-   `url` **[string][505]** a url to request from storage
-   `type` **[string][505]?** specify the type of the returned result
-   `withCredentials` **[boolean][509]?** 
-   `headers` **[object][507]?** 

Returns **[Promise][510]&lt;([Blob][535] \| [string][505] \| [JSON][531] \| [Document][520] | XMLDocument)>** 

### retrieve

Request a url from storage

#### Parameters

-   `url` **[string][505]** a url to request from storage
-   `type` **[string][505]?** specify the type of the returned result

Returns **[Promise][510]&lt;([Blob][535] \| [string][505] \| [JSON][531] \| [Document][520] | XMLDocument)>** 

### getBlob

Get a Blob from Storage by Url

#### Parameters

-   `url` **[string][505]** 
-   `mimeType` **[string][505]?** 

Returns **[Blob][535]** 

### getText

Get Text from Storage by Url

#### Parameters

-   `url` **[string][505]** 
-   `mimeType` **[string][505]?** 

Returns **[string][505]** 

### getBase64

Get a base64 encoded result from Storage by Url

#### Parameters

-   `url` **[string][505]** 
-   `mimeType` **[string][505]?** 

Returns **[string][505]** base64 encoded

### createUrl

Create a Url from a stored item

#### Parameters

-   `url` **[string][505]** 
-   `options`  

Returns **[Promise][510]** url promise with Url string

### revokeUrl

Revoke Temp Url for a achive item

#### Parameters

-   `url` **[string][505]** url of the item in the store

## Rendition

Displays an Epub as a series of Views for each Section.
Requires Manager and View class to handle specifics of rendering
the section content.

### Parameters

-   `book` **[Book][508]** 
-   `options` **[object][507]?** 
    -   `options.width` **[number][528]?** 
    -   `options.height` **[number][528]?** 
    -   `options.ignoreClass` **[string][505]?** class for the cfi parser to ignore
    -   `options.manager` **([string][505] \| [function][533] \| [object][507])**  (optional, default `'default'`)
    -   `options.view` **([string][505] \| [function][533])**  (optional, default `'iframe'`)
    -   `options.layout` **[string][505]?** layout to force
    -   `options.spread` **[string][505]?** force spread value
    -   `options.minSpreadWidth` **[number][528]?** overridden by spread: none (never) / both (always)
    -   `options.stylesheet` **[string][505]?** url of stylesheet to be injected
    -   `options.resizeOnOrientationChange` **[boolean][509]?** false to disable orientation events
    -   `options.script` **[string][505]?** url of script to be injected
    -   `options.snap` **([boolean][509] \| [object][507])** use snap scrolling (optional, default `false`)

### setManager

Set the manager function

#### Parameters

-   `manager` **[function][533]** 

### requireManager

Require the manager from passed string, or as a class function

#### Parameters

-   `manager` **([string][505] \| [object][507])** [description]

Returns **method** 

### requireView

Require the view from passed string, or as a class function

#### Parameters

-   `view` **([string][505] \| [object][507])** 

Returns **view** 

### start

Start the rendering

Returns **[Promise][510]** rendering has started

### attachTo

Call to attach the container to an element in the dom
Container must be attached before rendering can begin

#### Parameters

-   `element` **[element][512]** to attach to

Returns **[Promise][510]** 

### display

Display a point in the book
The request will be added to the rendering Queue,
so it will wait until book is opened, rendering started
and all other rendering tasks have finished to be called.

#### Parameters

-   `target` **[string][505]** Url or EpubCFI

Returns **[Promise][510]** 

### moveTo

Move the Rendition to a specific offset
Usually you would be better off calling display()

#### Parameters

-   `offset` **[object][507]** 

### resize

Trigger a resize of the views

#### Parameters

-   `width` **[number][528]?** 
-   `height` **[number][528]?** 
-   `epubcfi` **[string][505]?** (optional)

### clear

Clear all rendered views

### next

Go to the next "page" in the rendition

Returns **[Promise][510]** 

### prev

Go to the previous "page" in the rendition

Returns **[Promise][510]** 

### flow

Adjust the flow of the rendition to paginated or scrolled
(scrolled-continuous vs scrolled-doc are handled by different view managers)

#### Parameters

-   `flow` **[string][505]** 

### layout

Adjust the layout of the rendition to reflowable or pre-paginated

#### Parameters

-   `settings` **[object][507]** 

### spread

Adjust if the rendition uses spreads

#### Parameters

-   `spread` **[string][505]** none | auto (TODO: implement landscape, portrait, both)
-   `min` **int?** min width to use spreads at

### direction

Adjust the direction of the rendition

#### Parameters

-   `dir` **[string][505]** 

### reportLocation

Report the current location

### currentLocation

Get the Current Location object

Returns **(displayedLocation | [promise][510])** location (may be a promise)

### destroy

Remove and Clean Up the Rendition

### getRange

Get a Range from a Visible CFI

#### Parameters

-   `cfi` **[string][505]** EpubCfi String
-   `ignoreClass` **[string][505]** 

Returns **[range][515]** 

### getContents

Get the Contents object of each rendered view

Returns **[Array][529]&lt;[Contents][537]>** 

### views

Get the views member from the manager

Returns **Views** 

### hooks

Adds Hook methods to the Rendition prototype

Type: [object][507]

### themes

Type: [Themes][538]

### annotations

Type: [Annotations][539]

### location

A Rendered Location Range

Type: [Object][507]

#### Properties

-   `start` **[object][507]** 
    -   `start.index` **[string][505]** 
    -   `start.href` **[string][505]** 
    -   `start.displayed` **[object][507]** 
        -   `start.displayed.page` **[number][528]** 
        -   `start.displayed.total` **[number][528]** 
    -   `start.cfi` **[EpubCFI][514]** 
    -   `start.location` **[number][528]** 
    -   `start.percentage` **[number][528]** 
-   `end` **[object][507]** 
    -   `end.index` **[string][505]** 
    -   `end.href` **[string][505]** 
    -   `end.displayed` **[object][507]** 
        -   `end.displayed.page` **[number][528]** 
        -   `end.displayed.total` **[number][528]** 
    -   `end.cfi` **[EpubCFI][514]** 
    -   `end.location` **[number][528]** 
    -   `end.percentage` **[number][528]** 
-   `atStart` **[boolean][509]** 
-   `atEnd` **[boolean][509]** 

### started

### started

Emit that rendering has started

### attached

Emit that rendering has attached to an element

### displayed

Emit that a section has been displayed

#### Parameters

-   `section` **[Section][511]** 

### displayError

Emit that has been an error displaying

#### Parameters

-   `section` **[Section][511]** 

### rendered

Emit that a section has been rendered

#### Parameters

-   `section` **[Section][511]** 
-   `view` **View** 

### removed

Emit that a section has been removed

#### Parameters

-   `section` **[Section][511]** 
-   `view` **View** 

### resized

Emit that the rendition has been resized

#### Parameters

-   `width` **[number][528]** 
-   `height` **height** 
-   `epubcfi` **[string][505]** (optional)

### orientationchange

Emit that the rendition has been rotated

#### Parameters

-   `orientation` **[string][505]** 

### locationChanged

Type: [object][507]

#### Properties

-   `index` **[number][528]** 
-   `href` **[string][505]** 
-   `start` **[EpubCFI][514]** 
-   `end` **[EpubCFI][514]** 
-   `percentage` **[number][528]** 

**Meta**

-   **deprecated**: This is deprecated.


### relocated

Type: displayedLocation

### selected

Emit that a text selection has occured

#### Parameters

-   `cfirange` **[EpubCFI][514]** 
-   `contents` **[Contents][537]** 

### markClicked

Emit that a mark was clicked

#### Parameters

-   `cfirange` **[EpubCFI][514]** 
-   `data` **[object][507]** 
-   `contents` **[Contents][537]** 

## Hook

Hooks allow for injecting functions that must all complete in order before finishing
They will execute in parallel but all must finish before continuing
Functions may return a promise if they are asycn.

### Parameters

-   `context` **any** scope of this

### Examples

```javascript
this.content = new EPUBJS.Hook(this);
```

### register

Adds a function to be run before a hook completes

#### Examples

```javascript
this.content.register(function(){...});
```

### deregister

Removes a function

#### Parameters

-   `func`  

#### Examples

```javascript
this.content.deregister(function(){...});
```

### trigger

Triggers a hook to run all functions

#### Examples

```javascript
this.content.trigger(args).then(function(){...});
```

## Queue

Queue for handling tasks one at a time

### Parameters

-   `context` **scope** what this will resolve to in the tasks

### enqueue

Add an item to the queue

Returns **[Promise][510]** 

### dequeue

Run one item

Returns **[Promise][510]** 

### run

Run all tasks sequentially, at convince

Returns **[Promise][510]** 

### flush

Flush all, as quickly as possible

Returns **[Promise][510]** 

### clear

Clear all items in wait

### length

Get the number of tasks in the queue

Returns **[number][528]** tasks

### pause

Pause a running queue

### stop

End the queue

## Layout

Figures out the CSS values to apply for a layout

### Parameters

-   `settings` **[object][507]** 
    -   `settings.layout` **[string][505]**  (optional, default `'reflowable'`)
    -   `settings.spread` **[string][505]?** 
    -   `settings.minSpreadWidth` **[number][528]**  (optional, default `800`)
    -   `settings.evenSpreads` **[boolean][509]**  (optional, default `false`)

### flow

Switch the flow between paginated and scrolled

#### Parameters

-   `flow` **[string][505]** paginated | scrolled

Returns **[string][505]** simplified flow

### spread

Switch between using spreads or not, and set the
width at which they switch to single.

#### Parameters

-   `spread` **[string][505]** "none" | "always" | "auto"
-   `min` **[number][528]** integer in pixels

Returns **[boolean][509]** spread true | false

### calculate

Calculate the dimensions of the pagination

#### Parameters

-   `_width` **[number][528]** width of the rendering
-   `_height` **[number][528]** height of the rendering
-   `_gap` **[number][528]** width of the gap between columns

### format

Apply Css to a Document

#### Parameters

-   `contents` **[Contents][537]** 
-   `section`  
-   `axis`  

Returns **[Promise][510]** 

### count

Count number of pages

#### Parameters

-   `totalLength` **[number][528]** 
-   `pageLength` **[number][528]** 

Returns **{spreads: [Number][528], pages: [Number][528]}** 

## Themes

Themes to apply to displayed content

### Parameters

-   `rendition` **[Rendition][513]** 

### register

Add themes to be used by a rendition

#### Examples

```javascript
themes.register("light", "http://example.com/light.css")
```

```javascript
themes.register("light", { "body": { "color": "purple"}})
```

```javascript
themes.register({ "light" : {...}, "dark" : {...}})
```

### default

Add a default theme to be used by a rendition

#### Parameters

-   `theme` **([object][507] \| [string][505])** 

#### Examples

```javascript
themes.register("http://example.com/default.css")
```

```javascript
themes.register({ "body": { "color": "purple"}})
```

### registerThemes

Register themes object

#### Parameters

-   `themes` **[object][507]** 

### registerCss

Register a theme by passing its css as string

#### Parameters

-   `name` **[string][505]** 
-   `css` **[string][505]** 

### registerUrl

Register a url

#### Parameters

-   `name` **[string][505]** 
-   `input` **[string][505]** 

### registerRules

Register rule

#### Parameters

-   `name` **[string][505]** 
-   `rules` **[object][507]** 

### select

Select a theme

#### Parameters

-   `name` **[string][505]** 

### update

Update a theme

#### Parameters

-   `name` **[string][505]** 

### inject

Inject all themes into contents

#### Parameters

-   `contents` **[Contents][537]** 

### add

Add Theme to contents

#### Parameters

-   `name` **[string][505]** 
-   `contents` **[Contents][537]** 

### override

Add override

#### Parameters

-   `name` **[string][505]** 
-   `value` **[string][505]** 
-   `priority` **[boolean][509]** 

### overrides

Add all overrides

#### Parameters

-   `contents`  
-   `content` **Content** 

### fontSize

Adjust the font size of a rendition

#### Parameters

-   `size` **[number][528]** 

### font

Adjust the font-family of a rendition

#### Parameters

-   `f` **[string][505]** 

## Annotations

Handles managing adding & removing Annotations

### Parameters

-   `rendition` **[Rendition][513]** 

### add

Add an annotation to store

#### Parameters

-   `type` **[string][505]** Type of annotation to add: "highlight", "underline", "mark"
-   `cfiRange` **[EpubCFI][514]** EpubCFI range to attach annotation to
-   `data` **[object][507]** Data to assign to annotation
-   `cb` **[function][533]?** Callback after annotation is added
-   `className` **[string][505]** CSS class to assign to annotation
-   `styles` **[object][507]** CSS styles to assign to annotation

Returns **[Annotation][540]** annotation

### remove

Remove an annotation from store

#### Parameters

-   `cfiRange` **[EpubCFI][514]** EpubCFI range the annotation is attached to
-   `type` **[string][505]** Type of annotation to add: "highlight", "underline", "mark"

### highlight

Add a highlight to the store

#### Parameters

-   `cfiRange` **[EpubCFI][514]** EpubCFI range to attach annotation to
-   `data` **[object][507]** Data to assign to annotation
-   `cb` **[function][533]** Callback after annotation is clicked
-   `className` **[string][505]** CSS class to assign to annotation
-   `styles` **[object][507]** CSS styles to assign to annotation

### underline

Add a underline to the store

#### Parameters

-   `cfiRange` **[EpubCFI][514]** EpubCFI range to attach annotation to
-   `data` **[object][507]** Data to assign to annotation
-   `cb` **[function][533]** Callback after annotation is clicked
-   `className` **[string][505]** CSS class to assign to annotation
-   `styles` **[object][507]** CSS styles to assign to annotation

### mark

Add a mark to the store

#### Parameters

-   `cfiRange` **[EpubCFI][514]** EpubCFI range to attach annotation to
-   `data` **[object][507]** Data to assign to annotation
-   `cb` **[function][533]** Callback after annotation is clicked

### each

iterate over annotations in the store

### show

[Not Implemented] Show annotations

### hide

[Not Implemented] Hide annotations

## Annotation

Annotation object

### Parameters

-   `$0` **[Object][507]** 
    -   `$0.type`  
    -   `$0.cfiRange`  
    -   `$0.data`  
    -   `$0.sectionIndex`  
    -   `$0.cb`  
    -   `$0.className`  
    -   `$0.styles`  
-   `options` **[object][507]** 
    -   `options.type` **[string][505]** Type of annotation to add: "highlight", "underline", "mark"
    -   `options.cfiRange` **[EpubCFI][514]** EpubCFI range to attach annotation to
    -   `options.data` **[object][507]** Data to assign to annotation
    -   `options.sectionIndex` **int** Index in the Spine of the Section annotation belongs to
    -   `options.cb` **[function][533]?** Callback after annotation is clicked
-   `className` **[string][505]** CSS class to assign to annotation
-   `styles` **[object][507]** CSS styles to assign to annotation

Returns **[Annotation][540]** annotation

### update

Update stored data

#### Parameters

-   `data` **[object][507]** 

### attach

Add to a view

#### Parameters

-   `view` **View** 

### detach

Remove from a view

#### Parameters

-   `view` **View** 

### text

[Not Implemented] Get text of an annotation

## EpubCFI

Parsing and creation of EpubCFIs: [http://www.idpf.org/epub/linking/cfi/epub-cfi.html][541]

Implements:

-   Character Offset: epubcfi(/6/4[chap01ref]!/4[body01]/10[para05]/2/1:3)
-   Simple Ranges : epubcfi(/6/4[chap01ref]!/4[body01]/10[para05],/2/1:1,/3:4)

Does Not Implement:

-   Temporal Offset (~)
-   Spatial Offset (@)
-   Temporal-Spatial Offset (~ + @)
-   Text Location Assertion (\[)

### Parameters

-   `cfiFrom` **([string][505] \| [Range][515] \| [Node][542])?** 
-   `base` **([string][505] \| [object][507])?** 
-   `ignoreClass` **[string][505]?** class to ignore when parsing DOM

### parse

Parse a cfi string to a CFI object representation

#### Parameters

-   `cfiStr` **[string][505]** 

Returns **[object][507]** cfi

### toString

Convert CFI to a epubcfi(...) string

Returns **[string][505]** epubcfi

### compare

Compare which of two CFIs is earlier in the text

#### Parameters

-   `cfiOne`  
-   `cfiTwo`  

Returns **[number][528]** First is earlier = -1, Second is earlier = 1, They are equal = 0

### fromRange

Create a CFI object from a Range

#### Parameters

-   `range` **[Range][515]** 
-   `base` **([string][505] \| [object][507])** 
-   `ignoreClass` **[string][505]?** 

Returns **[object][507]** cfi

### fromNode

Create a CFI object from a Node

#### Parameters

-   `anchor` **[Node][542]** 
-   `base` **([string][505] \| [object][507])** 
-   `ignoreClass` **[string][505]?** 

Returns **[object][507]** cfi

### toRange

Creates a DOM range representing a CFI

#### Parameters

-   `_doc` **[document][520]** document referenced in the base
-   `ignoreClass` **[string][505]?** 

Returns **[Range][515]** 

### isCfiString

Check if a string is wrapped with "epubcfi()"

#### Parameters

-   `str` **[string][505]** 

Returns **[boolean][509]** 

### collapse

Collapse a CFI Range to a single CFI Position

#### Parameters

-   `toStart` **[boolean][509]**  (optional, default `false`)

## Contents

Handles DOM manipulation, queries and events for View contents

### Parameters

-   `doc` **[document][520]** Document
-   `content` **[element][512]** Parent Element (typically Body)
-   `cfiBase` **[string][505]** Section component of CFIs
-   `sectionIndex` **[number][528]** Index in Spine of Conntent's Section

### width

Get or Set width

#### Parameters

-   `w` **[number][528]?** 

Returns **[number][528]** width

### height

Get or Set height

#### Parameters

-   `h` **[number][528]?** 

Returns **[number][528]** height

### contentWidth

Get or Set width of the contents

#### Parameters

-   `w` **[number][528]?** 

Returns **[number][528]** width

### contentHeight

Get or Set height of the contents

#### Parameters

-   `h` **[number][528]?** 

Returns **[number][528]** height

### textWidth

Get the width of the text using Range

Returns **[number][528]** width

### textHeight

Get the height of the text using Range

Returns **[number][528]** height

### scrollWidth

Get documentElement scrollWidth

Returns **[number][528]** width

### scrollHeight

Get documentElement scrollHeight

Returns **[number][528]** height

### overflow

Set overflow css style of the contents

#### Parameters

-   `overflow` **[string][505]?** 

### overflowX

Set overflowX css style of the documentElement

#### Parameters

-   `overflow` **[string][505]?** 

### overflowY

Set overflowY css style of the documentElement

#### Parameters

-   `overflow` **[string][505]?** 

### css

Set Css styles on the contents element (typically Body)

#### Parameters

-   `property` **[string][505]** 
-   `value` **[string][505]** 
-   `priority` **[boolean][509]?** set as "important"

### viewport

Get or Set the viewport element

#### Parameters

-   `options` **[object][507]?** 
    -   `options.width` **[string][505]?** 
    -   `options.height` **[string][505]?** 
    -   `options.scale` **[string][505]?** 
    -   `options.minimum` **[string][505]?** 
    -   `options.maximum` **[string][505]?** 
    -   `options.scalable` **[string][505]?** 

### root

Get the documentElement

Returns **[element][512]** documentElement

### locationOf

Get the location offset of a EpubCFI or an #id

#### Parameters

-   `target` **([string][505] \| [EpubCFI][514])** 
-   `ignoreClass` **[string][505]?** for the cfi

### addStylesheet

Append a stylesheet link to the document head

#### Parameters

-   `src` **[string][505]** url

### addStylesheetCss

Append stylesheet css

#### Parameters

-   `serializedCss` **[string][505]** 
-   `key` **[string][505]** If the key is the same, the CSS will be replaced instead of inserted

### addStylesheetRules

Append stylesheet rules to a generate stylesheet
Array: [https://developer.mozilla.org/en-US/docs/Web/API/CSSStyleSheet/insertRule][543]
Object: [https://github.com/desirable-objects/json-to-css][544]

#### Parameters

-   `rules` **([array][529] \| [object][507])** 
-   `key` **[string][505]** If the key is the same, the CSS will be replaced instead of inserted

### addScript

Append a script tag to the document head

#### Parameters

-   `src` **[string][505]** url

Returns **[Promise][510]** loaded

### addClass

Add a class to the contents container

#### Parameters

-   `className` **[string][505]** 

### removeClass

Remove a class from the contents container

#### Parameters

-   `className`  
-   `removeClass` **[string][505]** 

### range

Get a Dom Range from EpubCFI

#### Parameters

-   `_cfi` **[EpubCFI][514]** 
-   `ignoreClass` **[string][505]?** 

Returns **[Range][515]** range

### cfiFromRange

Get an EpubCFI from a Dom Range

#### Parameters

-   `range` **[Range][515]** 
-   `ignoreClass` **[string][505]?** 

Returns **[EpubCFI][514]** cfi

### cfiFromNode

Get an EpubCFI from a Dom node

#### Parameters

-   `node` **[node][542]** 
-   `ignoreClass` **[string][505]?** 

Returns **[EpubCFI][514]** cfi

### size

Size the contents to a given width and height

#### Parameters

-   `width` **[number][528]?** 
-   `height` **[number][528]?** 

### columns

Apply columns to the contents for pagination

#### Parameters

-   `width` **[number][528]** 
-   `height` **[number][528]** 
-   `columnWidth` **[number][528]** 
-   `gap` **[number][528]** 
-   `dir`  

### scaler

Scale contents from center

#### Parameters

-   `scale` **[number][528]** 
-   `offsetX` **[number][528]** 
-   `offsetY` **[number][528]** 

### fit

Fit contents into a fixed width and height

#### Parameters

-   `width` **[number][528]** 
-   `height` **[number][528]** 
-   `section`  

### direction

Set the direction of the text

#### Parameters

-   `dir` **[string][505]** "rtl" | "ltr" (optional, default `"ltr"`)

### writingMode

Set the writingMode of the text

#### Parameters

-   `mode` **[string][505]** "horizontal-tb" | "vertical-rl" | "vertical-lr" (optional, default `"horizontal-tb"`)

### listenedEvents

Get DOM events that are listened for and passed along

## Mapping

Map text locations to CFI ranges

### Parameters

-   `layout` **[Layout][545]** Layout to apply
-   `direction` **[string][505]** Text direction (optional, default `"ltr"`)
-   `axis` **[string][505]** vertical or horizontal axis (optional, default `"horizontal"`)
-   `dev` **[boolean][509]?** toggle developer highlighting (optional, default `false`)

### section

Find CFI pairs for entire section at once

#### Parameters

-   `view`  

### page

Find CFI pairs for a page

#### Parameters

-   `contents` **[Contents][537]** Contents from view
-   `cfiBase` **[string][505]** string of the base for a cfi
-   `start` **[number][528]** position to start at
-   `end` **[number][528]** position to end at

### axis

Set the axis for mapping

#### Parameters

-   `axis` **[string][505]** horizontal | vertical

Returns **[boolean][509]** is it horizontal?

## Core

Core Utilities and Helpers

### requestAnimationFrame

Vendor prefixed requestAnimationFrame

Returns **[function][533]** requestAnimationFrame

### uuid

Generates a UUID
based on: [http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript][546]

Returns **[string][505]** uuid

### documentHeight

Gets the height of a document

Returns **[number][528]** height

### isElement

Checks if a node is an element

#### Parameters

-   `obj` **[object][507]** 

Returns **[boolean][509]** 

### isNumber

#### Parameters

-   `n` **any** 

Returns **[boolean][509]** 

### isFloat

#### Parameters

-   `n` **any** 

Returns **[boolean][509]** 

### prefixed

Get a prefixed css property

#### Parameters

-   `unprefixed` **[string][505]** 

Returns **[string][505]** 

### defaults

Apply defaults to an object

#### Parameters

-   `obj` **[object][507]** 

Returns **[object][507]** 

### extend

Extend properties of an object

#### Parameters

-   `target` **[object][507]** 

Returns **[object][507]** 

### insert

Fast quicksort insert for sorted array -- based on:
 [http://stackoverflow.com/questions/1344500/efficient-way-to-insert-a-number-into-a-sorted-array-of-numbers][547]

#### Parameters

-   `item` **any** 
-   `array` **[array][529]** 
-   `compareFunction` **[function][533]?** 

Returns **[number][528]** location (in array)

### locationOf

Finds where something would fit into a sorted array

#### Parameters

-   `item` **any** 
-   `array` **[array][529]** 
-   `compareFunction` **[function][533]?** 
-   `_start` **[function][533]?** 
-   `_end` **[function][533]?** 

Returns **[number][528]** location (in array)

### indexOfSorted

Finds index of something in a sorted array
Returns -1 if not found

#### Parameters

-   `item` **any** 
-   `array` **[array][529]** 
-   `compareFunction` **[function][533]?** 
-   `_start` **[function][533]?** 
-   `_end` **[function][533]?** 

Returns **[number][528]** index (in array) or -1

### bounds

Find the bounds of an element
taking padding and margin into account

#### Parameters

-   `el` **[element][512]** 

Returns **{width: [Number][528], height: [Number][528]}** 

### borders

Find the bounds of an element
taking padding, margin and borders into account

#### Parameters

-   `el` **[element][512]** 

Returns **{width: [Number][528], height: [Number][528]}** 

### nodeBounds

Find the bounds of any node
allows for getting bounds of text nodes by wrapping them in a range

#### Parameters

-   `node` **[node][542]** 

Returns **BoundingClientRect** 

### windowBounds

Find the equivelent of getBoundingClientRect of a browser window

Returns **{width: [Number][528], height: [Number][528], top: [Number][528], left: [Number][528], right: [Number][528], bottom: [Number][528]}** 

### indexOfNode

Gets the index of a node in its parent

#### Parameters

-   `node` **[Node][542]** 
-   `typeId` **[string][505]** 

Returns **[number][528]** index

### indexOfTextNode

Gets the index of a text node in its parent

#### Parameters

-   `textNode` **[node][542]** 

Returns **[number][528]** index

### indexOfElementNode

Gets the index of an element node in its parent

#### Parameters

-   `elementNode` **[element][512]** 

Returns **[number][528]** index

### isXml

Check if extension is xml

#### Parameters

-   `ext` **[string][505]** 

Returns **[boolean][509]** 

### createBlob

Create a new blob

#### Parameters

-   `content` **any** 
-   `mime` **[string][505]** 

Returns **[Blob][535]** 

### createBlobUrl

Create a new blob url

#### Parameters

-   `content` **any** 
-   `mime` **[string][505]** 

Returns **[string][505]** url

### revokeBlobUrl

Remove a blob url

#### Parameters

-   `url` **[string][505]** 

### createBase64Url

Create a new base64 encoded url

#### Parameters

-   `content` **any** 
-   `mime` **[string][505]** 

Returns **[string][505]** url

### type

Get type of an object

#### Parameters

-   `obj` **[object][507]** 

Returns **[string][505]** type

### parse

Parse xml (or html) markup

#### Parameters

-   `markup` **[string][505]** 
-   `mime` **[string][505]** 
-   `forceXMLDom` **[boolean][509]** force using xmlDom to parse instead of native parser

Returns **[document][520]** document

### qs

querySelector polyfill

#### Parameters

-   `el` **[element][512]** 
-   `sel` **[string][505]** selector string

Returns **[element][512]** element

### qsa

querySelectorAll polyfill

#### Parameters

-   `el` **[element][512]** 
-   `sel` **[string][505]** selector string

Returns **[Array][529]&lt;[element][512]>** elements

### qsp

querySelector by property

#### Parameters

-   `el` **[element][512]** 
-   `sel` **[string][505]** selector string
-   `props` **[Array][529]&lt;[object][507]>** 

Returns **[Array][529]&lt;[element][512]>** elements

### sprint

Sprint through all text nodes in a document

#### Parameters

-   `root` **[element][512]** element to start with
-   `func` **[function][533]** function to run on each element

### treeWalker

Create a treeWalker

#### Parameters

-   `root` **[element][512]** element to start with
-   `func` **[function][533]** function to run on each element
-   `filter` **([function][533] \| [object][507])** funtion or object to filter with

### walk

#### Parameters

-   `node` **[node][542]** 
-   `callback`  
-   `return` **callback** false for continue,true for break inside callback

### blob2base64

Convert a blob to a base64 encoded string

#### Parameters

-   `blob` **Blog** 

Returns **[string][505]** 

### defer

Creates a new pending promise and provides methods to resolve or reject it.
From: [https://developer.mozilla.org/en-US/docs/Mozilla/JavaScript_code_modules/Promise.jsm/Deferred#backwards_forwards_compatible][548]

### querySelectorByType

querySelector with filter by epub type

#### Parameters

-   `html` **[element][512]** 
-   `element` **[string][505]** element type to find
-   `type` **[string][505]** epub type to find

Returns **[Array][529]&lt;[element][512]>** elements

### findChildren

Find direct decendents of an element

#### Parameters

-   `el` **[element][512]** 

Returns **[Array][529]&lt;[element][512]>** children

### parents

Find all parents (ancestors) of an element

#### Parameters

-   `node` **[element][512]** 

Returns **[Array][529]&lt;[element][512]>** parents

### filterChildren

Find all direct decendents of a specific type

#### Parameters

-   `el` **[element][512]** 
-   `nodeName` **[string][505]** 
-   `single` **[boolean][509]?** 

Returns **[Array][529]&lt;[element][512]>** children

### getParentByTagName

Filter all parents (ancestors) with tag name

#### Parameters

-   `node` **[element][512]** 
-   `tagname` **[string][505]** 

Returns **[Array][529]&lt;[element][512]>** parents

### RangeObject

Lightweight Polyfill for DOM Range

[1]: #epub

[2]: #parameters

[3]: #examples

[4]: #book

[5]: #parameters-1

[6]: #examples-1

[7]: #open

[8]: #parameters-2

[9]: #examples-2

[10]: #load

[11]: #parameters-3

[12]: #resolve

[13]: #parameters-4

[14]: #canonical

[15]: #parameters-5

[16]: #section

[17]: #parameters-6

[18]: #renderto

[19]: #parameters-7

[20]: #setrequestcredentials

[21]: #parameters-8

[22]: #setrequestheaders

[23]: #parameters-9

[24]: #coverurl

[25]: #getrange

[26]: #parameters-10

[27]: #key

[28]: #parameters-11

[29]: #destroy

[30]: #opened

[31]: #spine

[32]: #locations

[33]: #navigation

[34]: #pagelist

[35]: #displayoptions

[36]: #parameters-12

[37]: #parse

[38]: #parameters-13

[39]: #url

[40]: #parameters-14

[41]: #path

[42]: #resolve-1

[43]: #parameters-15

[44]: #relative

[45]: #parameters-16

[46]: #tostring

[47]: #path-1

[48]: #parameters-17

[49]: #parse-1

[50]: #parameters-18

[51]: #isabsolute

[52]: #parameters-19

[53]: #isdirectory

[54]: #parameters-20

[55]: #resolve-2

[56]: #parameters-21

[57]: #relative-1

[58]: #parameters-22

[59]: #tostring-1

[60]: #spine-1

[61]: #unpack

[62]: #parameters-23

[63]: #get

[64]: #parameters-24

[65]: #examples-3

[66]: #each

[67]: #first

[68]: #last

[69]: #section-1

[70]: #parameters-25

[71]: #load-1

[72]: #parameters-26

[73]: #render

[74]: #parameters-27

[75]: #find

[76]: #parameters-28

[77]: #search

[78]: #parameters-29

[79]: #reconcilelayoutsettings

[80]: #parameters-30

[81]: #cfifromrange

[82]: #parameters-31

[83]: #cfifromelement

[84]: #parameters-32

[85]: #unload

[86]: #locations-1

[87]: #parameters-33

[88]: #generate

[89]: #parameters-34

[90]: #generatefromwords

[91]: #parameters-35

[92]: #locationfromcfi

[93]: #parameters-36

[94]: #percentagefromcfi

[95]: #parameters-37

[96]: #percentagefromlocation

[97]: #parameters-38

[98]: #cfifromlocation

[99]: #parameters-39

[100]: #cfifrompercentage

[101]: #parameters-40

[102]: #load-2

[103]: #parameters-41

[104]: #save

[105]: #currentlocation

[106]: #currentlocation-1

[107]: #parameters-42

[108]: #length

[109]: #container

[110]: #parameters-43

[111]: #parse-2

[112]: #parameters-44

[113]: #packaging

[114]: #parameters-45

[115]: #parse-3

[116]: #parameters-46

[117]: #load-3

[118]: #parameters-47

[119]: #navigation-1

[120]: #parameters-48

[121]: #parse-4

[122]: #parameters-49

[123]: #get-1

[124]: #parameters-50

[125]: #getbyindex

[126]: #parameters-51

[127]: #landmark

[128]: #parameters-52

[129]: #load-4

[130]: #parameters-53

[131]: #foreach

[132]: #parameters-54

[133]: #resources

[134]: #parameters-55

[135]: #process

[136]: #parameters-56

[137]: #createurl

[138]: #parameters-57

[139]: #replacements

[140]: #relativeto

[141]: #parameters-58

[142]: #get-2

[143]: #parameters-59

[144]: #substitute

[145]: #parameters-60

[146]: #pagelist-1

[147]: #parameters-61

[148]: #parse-5

[149]: #parameters-62

[150]: #pagefromcfi

[151]: #parameters-63

[152]: #cfifrompage

[153]: #parameters-64

[154]: #pagefrompercentage

[155]: #parameters-65

[156]: #percentagefrompage

[157]: #parameters-66

[158]: #percentagefromcfi-1

[159]: #parameters-67

[160]: #destroy-1

[161]: #archive

[162]: #open-1

[163]: #parameters-68

[164]: #openurl

[165]: #parameters-69

[166]: #request

[167]: #parameters-70

[168]: #getblob

[169]: #parameters-71

[170]: #gettext

[171]: #parameters-72

[172]: #getbase64

[173]: #parameters-73

[174]: #createurl-1

[175]: #parameters-74

[176]: #revokeurl

[177]: #parameters-75

[178]: #store

[179]: #parameters-76

[180]: #add

[181]: #parameters-77

[182]: #put

[183]: #parameters-78

[184]: #request-1

[185]: #parameters-79

[186]: #retrieve

[187]: #parameters-80

[188]: #getblob-1

[189]: #parameters-81

[190]: #gettext-1

[191]: #parameters-82

[192]: #getbase64-1

[193]: #parameters-83

[194]: #createurl-2

[195]: #parameters-84

[196]: #revokeurl-1

[197]: #parameters-85

[198]: #rendition

[199]: #parameters-86

[200]: #setmanager

[201]: #parameters-87

[202]: #requiremanager

[203]: #parameters-88

[204]: #requireview

[205]: #parameters-89

[206]: #start

[207]: #attachto

[208]: #parameters-90

[209]: #display

[210]: #parameters-91

[211]: #moveto

[212]: #parameters-92

[213]: #resize

[214]: #parameters-93

[215]: #clear

[216]: #next

[217]: #prev

[218]: #flow

[219]: #parameters-94

[220]: #layout

[221]: #parameters-95

[222]: #spread

[223]: #parameters-96

[224]: #direction

[225]: #parameters-97

[226]: #reportlocation

[227]: #currentlocation-2

[228]: #destroy-2

[229]: #getrange-1

[230]: #parameters-98

[231]: #getcontents

[232]: #views

[233]: #hooks

[234]: #themes

[235]: #annotations

[236]: #location

[237]: #properties

[238]: #started

[239]: #started-1

[240]: #attached

[241]: #displayed

[242]: #parameters-99

[243]: #displayerror

[244]: #parameters-100

[245]: #rendered

[246]: #parameters-101

[247]: #removed

[248]: #parameters-102

[249]: #resized

[250]: #parameters-103

[251]: #orientationchange

[252]: #parameters-104

[253]: #locationchanged

[254]: #properties-1

[255]: #relocated

[256]: #selected

[257]: #parameters-105

[258]: #markclicked

[259]: #parameters-106

[260]: #hook

[261]: #parameters-107

[262]: #examples-4

[263]: #register

[264]: #examples-5

[265]: #deregister

[266]: #parameters-108

[267]: #examples-6

[268]: #trigger

[269]: #examples-7

[270]: #queue

[271]: #parameters-109

[272]: #enqueue

[273]: #dequeue

[274]: #run

[275]: #flush

[276]: #clear-1

[277]: #length-1

[278]: #pause

[279]: #stop

[280]: #layout-1

[281]: #parameters-110

[282]: #flow-1

[283]: #parameters-111

[284]: #spread-1

[285]: #parameters-112

[286]: #calculate

[287]: #parameters-113

[288]: #format

[289]: #parameters-114

[290]: #count

[291]: #parameters-115

[292]: #themes-1

[293]: #parameters-116

[294]: #register-1

[295]: #examples-8

[296]: #default

[297]: #parameters-117

[298]: #examples-9

[299]: #registerthemes

[300]: #parameters-118

[301]: #registercss

[302]: #parameters-119

[303]: #registerurl

[304]: #parameters-120

[305]: #registerrules

[306]: #parameters-121

[307]: #select

[308]: #parameters-122

[309]: #update

[310]: #parameters-123

[311]: #inject

[312]: #parameters-124

[313]: #add-1

[314]: #parameters-125

[315]: #override

[316]: #parameters-126

[317]: #overrides

[318]: #parameters-127

[319]: #fontsize

[320]: #parameters-128

[321]: #font

[322]: #parameters-129

[323]: #annotations-1

[324]: #parameters-130

[325]: #add-2

[326]: #parameters-131

[327]: #remove

[328]: #parameters-132

[329]: #highlight

[330]: #parameters-133

[331]: #underline

[332]: #parameters-134

[333]: #mark

[334]: #parameters-135

[335]: #each-1

[336]: #show

[337]: #hide

[338]: #annotation

[339]: #parameters-136

[340]: #update-1

[341]: #parameters-137

[342]: #attach

[343]: #parameters-138

[344]: #detach

[345]: #parameters-139

[346]: #text

[347]: #epubcfi

[348]: #parameters-140

[349]: #parse-6

[350]: #parameters-141

[351]: #tostring-2

[352]: #compare

[353]: #parameters-142

[354]: #fromrange

[355]: #parameters-143

[356]: #fromnode

[357]: #parameters-144

[358]: #torange

[359]: #parameters-145

[360]: #iscfistring

[361]: #parameters-146

[362]: #collapse

[363]: #parameters-147

[364]: #contents

[365]: #parameters-148

[366]: #width

[367]: #parameters-149

[368]: #height

[369]: #parameters-150

[370]: #contentwidth

[371]: #parameters-151

[372]: #contentheight

[373]: #parameters-152

[374]: #textwidth

[375]: #textheight

[376]: #scrollwidth

[377]: #scrollheight

[378]: #overflow

[379]: #parameters-153

[380]: #overflowx

[381]: #parameters-154

[382]: #overflowy

[383]: #parameters-155

[384]: #css

[385]: #parameters-156

[386]: #viewport

[387]: #parameters-157

[388]: #root

[389]: #locationof

[390]: #parameters-158

[391]: #addstylesheet

[392]: #parameters-159

[393]: #addstylesheetcss

[394]: #parameters-160

[395]: #addstylesheetrules

[396]: #parameters-161

[397]: #addscript

[398]: #parameters-162

[399]: #addclass

[400]: #parameters-163

[401]: #removeclass

[402]: #parameters-164

[403]: #range

[404]: #parameters-165

[405]: #cfifromrange-1

[406]: #parameters-166

[407]: #cfifromnode

[408]: #parameters-167

[409]: #size

[410]: #parameters-168

[411]: #columns

[412]: #parameters-169

[413]: #scaler

[414]: #parameters-170

[415]: #fit

[416]: #parameters-171

[417]: #direction-1

[418]: #parameters-172

[419]: #writingmode

[420]: #parameters-173

[421]: #listenedevents

[422]: #mapping

[423]: #parameters-174

[424]: #section-2

[425]: #parameters-175

[426]: #page

[427]: #parameters-176

[428]: #axis

[429]: #parameters-177

[430]: #core

[431]: #requestanimationframe

[432]: #uuid

[433]: #documentheight

[434]: #iselement

[435]: #parameters-178

[436]: #isnumber

[437]: #parameters-179

[438]: #isfloat

[439]: #parameters-180

[440]: #prefixed

[441]: #parameters-181

[442]: #defaults

[443]: #parameters-182

[444]: #extend

[445]: #parameters-183

[446]: #insert

[447]: #parameters-184

[448]: #locationof-1

[449]: #parameters-185

[450]: #indexofsorted

[451]: #parameters-186

[452]: #bounds

[453]: #parameters-187

[454]: #borders

[455]: #parameters-188

[456]: #nodebounds

[457]: #parameters-189

[458]: #windowbounds

[459]: #indexofnode

[460]: #parameters-190

[461]: #indexoftextnode

[462]: #parameters-191

[463]: #indexofelementnode

[464]: #parameters-192

[465]: #isxml

[466]: #parameters-193

[467]: #createblob

[468]: #parameters-194

[469]: #createbloburl

[470]: #parameters-195

[471]: #revokebloburl

[472]: #parameters-196

[473]: #createbase64url

[474]: #parameters-197

[475]: #type

[476]: #parameters-198

[477]: #parse-7

[478]: #parameters-199

[479]: #qs

[480]: #parameters-200

[481]: #qsa

[482]: #parameters-201

[483]: #qsp

[484]: #parameters-202

[485]: #sprint

[486]: #parameters-203

[487]: #treewalker

[488]: #parameters-204

[489]: #walk

[490]: #parameters-205

[491]: #blob2base64

[492]: #parameters-206

[493]: #defer

[494]: #queryselectorbytype

[495]: #parameters-207

[496]: #findchildren

[497]: #parameters-208

[498]: #parents

[499]: #parameters-209

[500]: #filterchildren

[501]: #parameters-210

[502]: #getparentbytagname

[503]: #parameters-211

[504]: #rangeobject

[505]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String

[506]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer

[507]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object

[508]: #book

[509]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean

[510]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise

[511]: #section

[512]: https://developer.mozilla.org/docs/Web/API/Element

[513]: #rendition

[514]: #epubcfi

[515]: https://developer.mozilla.org/docs/Web/HTML/Element/Input

[516]: #spine

[517]: #locations

[518]: #navigation

[519]: #pagelist

[520]: https://developer.mozilla.org/docs/Web/API/Document

[521]: #displayoptions

[522]: #path

[523]: https://nodejs.org/api/path.html

[524]: https://nodejs.org/api/path.html#path_path_parse_path

[525]: https://nodejs.org/api/path.html#path_path_resolve_paths

[526]: https://nodejs.org/api/path.html#path_path_relative_from_to

[527]: #packaging

[528]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number

[529]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array

[530]: https://developer.mozilla.org/Add-ons/SDK/High-Level_APIs/request

[531]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/JSON

[532]: https://idpf.github.io/epub-vocabs/structure/

[533]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function

[534]: #archive

[535]: https://developer.mozilla.org/docs/Web/API/Blob

[536]: #resources

[537]: #contents

[538]: #themes

[539]: #annotations

[540]: #annotation

[541]: http://www.idpf.org/epub/linking/cfi/epub-cfi.html

[542]: https://developer.mozilla.org/docs/Web/API/Node/nextSibling

[543]: https://developer.mozilla.org/en-US/docs/Web/API/CSSStyleSheet/insertRule

[544]: https://github.com/desirable-objects/json-to-css

[545]: #layout

[546]: http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript

[547]: http://stackoverflow.com/questions/1344500/efficient-way-to-insert-a-number-into-a-sorted-array-of-numbers

[548]: https://developer.mozilla.org/en-US/docs/Mozilla/JavaScript_code_modules/Promise.jsm/Deferred#backwards_forwards_compatible
